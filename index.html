<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>모두의 수시 3개년 입시결과 비교 온도계</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",sans-serif;
background:linear-gradient(180deg,#ffe4cf,#fdefff,#e8f5ff);
}

/* 전체 컨테이너 */
.page{
max-width:1200px;
margin:0 auto;
padding:10px 10px 60px;
}

h1{
font-size:28px;
font-weight:900;
margin:8px 0 4px;
}

/* ================== 검색창 카드 ================== */

.search-card{
background:white;
border-radius:18px;
padding:18px;
box-shadow:0 10px 35px rgba(0,0,0,.09);
margin-top:10px;
}

/* 검색 select + button */
.search-row{
display:flex;
gap:8px;
flex-wrap:wrap;
}

select{
flex:1;
padding:14px 14px;
font-size:16px;
font-weight:900;
border-radius:14px;
border:2px solid #ffc2a1;
background:#fffdfb;
}

button{
padding:14px 18px;
font-size:15px;
font-weight:900;
border-radius:14px;
border:none;
cursor:pointer;
}

.btn-main{background:linear-gradient(120deg,#ff7b61,#ff3d7a);color:white}
.btn-sub{background:white;color:#444;border:2px solid #eee}

/* ================== 카드 구분 ================== */
.card-current{
background:white;
padding:14px 16px;
border-radius:16px;
box-shadow:0 8px 28px rgba(255,100,120,.25);
border-left:10px solid #ff6070;
margin-top:12px;
}

.card-compare{
background:white;
padding:14px 16px;
border-radius:16px;
box-shadow:0 8px 28px rgba(90,140,255,.25);
border-left:10px solid #6c8dff;
margin-top:12px;
}

/* ================= thermometer ================== */

.thermo-box{
display:flex;
gap:16px;
margin-top:6px;
}

.thermo-col{
flex:1;
text-align:center;
font-weight:900;
}

/* thermometer body */
.thermo{
width:70px;
height:180px;
margin:0 auto;
position:relative;
}

/* tube */
.tube{
position:absolute;
left:50%;
transform:translateX(-50%);
bottom:28px;
width:18px;
height:130px;
border-radius:14px;
background:#eef3ff;
box-shadow:inset 0 0 6px rgba(0,0,0,.35);
overflow:hidden;
}

/* thermometer fill */
.fill{
position:absolute;
bottom:0;
left:0;
width:100%;
border-radius:14px;
transition:height .6s ease;
}

/* bulb */
.bulb{
position:absolute;
width:34px;
height:34px;
border-radius:50%;
bottom:-1px;
left:50%;
transform:translateX(-50%);
}

/* tick labels */
.scale{
position:absolute;
top:6px;
right:-34px;
font-size:11px;
line-height:1.1;
}

/* ================= table ================= */

table{
width:100%;
border-collapse:collapse;
margin-top:8px;
font-size:13px;
}

th,td{
padding:6px;
text-align:center;
border-bottom:1px solid #eee;
}

th{
background:#fff3ea;
font-weight:900;
}

/* 2025 strong highlight */
tr.year2025{
background:#fffbe1;
font-weight:900;
}

/* arrow */
.up{color:#e74c3c;font-weight:900}
.down{color:#2980b9;font-weight:900}

/* ================= mobile ================= */
@media(max-width:640px){
select{font-size:18px;padding:16px}
button{font-size:18px}
.thermo{transform:scale(.9)}
}
</style>
</head>

<body>

<div class="page">

<h1>모두의 수시 3개년 입시결과 비교 온도계</h1>
<div>대학교 · 모집단위 · 전형유형 · 세부전형 선택 후 비교</div>
<div><b>Copyright @All Teachers</b></div>
<div>출처 3개년 어디가 수시 입시결과</div>

<!-- 검색 -->
<div class="search-card">
<div class="search-row">
<select id="univ"></select>
<select id="major" disabled></select>
<select id="type" disabled></select>
<select id="detail" disabled></select>
<button id="btnAdd" class="btn-main">비교 추가</button>
<button id="btnReset" class="btn-sub">초기화</button>
</div>
</div>

<div id="currentBox" class="card-current">
현재 선택된 전형이 없습니다.
</div>

<div id="compareBox" class="card-compare">
비교 목록이 비어 있습니다.
</div>

</div>

<script>
const YEARS=[2025,2024,2023];
let DATA=[];
let compare=[];

/* ========== load json faster (mobile optimized) ========= */
async function load(){
 const r=await fetch("data/data.json");
 DATA=await r.json();
 DATA.forEach(d=>d._year=parseInt(d["연도"]));
 initUniv();
}

/* fill select */
function unique(a){return [...new Set(a)].sort((a,b)=>a.localeCompare(b,"ko"))}
function fill(sel,list,title){
 sel.innerHTML=`<option value="">${title}</option>`;
 list.forEach(v=>{
  sel.innerHTML+=`<option value="${v}">${v}</option>`;
 });
}

/* selects */
const univ=document.getElementById("univ");
const major=document.getElementById("major");
const type=document.getElementById("type");
const detail=document.getElementById("detail");

function initUniv(){
 fill(univ,unique(DATA.map(r=>r["대학명"])),"대학 선택");
}

univ.onchange=()=>{
 const f=DATA.filter(r=>r["대학명"]===univ.value);
 fill(major,unique(f.map(r=>r["모집단위"])),"모집단위 선택");
 major.disabled=false;
}

major.onchange=()=>{
 const f=DATA.filter(r=>r["대학명"]===univ.value && r["모집단위"]===major.value);
 fill(type,unique(f.map(r=>r["중심전형"])),"전형 선택");
 type.disabled=false;
}

type.onchange=()=>{
 const f=DATA.filter(r=>r["대학명"]===univ.value && r["모집단위"]===major.value && r["중심전형"]===type.value);
 fill(detail,unique(f.map(r=>r["전형명"])),"세부전형 선택");
 detail.disabled=false;
}

detail.onchange=()=>renderCurrent();

/* get rows by year */
function rows(){
 let by={};
 YEARS.forEach(y=>{
  by[y]=DATA.find(r=>
   r._year===y &&
   r["대학명"]===univ.value &&
   r["모집단위"]===major.value &&
   r["중심전형"]===type.value &&
   r["전형명"]===detail.value
  )||null;
 });
 return by;
}

/* arrow up down */
function arrow(prev,val){
 if(prev==null||val==null) return "";
 return val<prev?`<span class="up">▲</span>`:`<span class="down">▼</span>`;
}

/* thermometer block */
function thermoBlock(by){
 const box=document.createElement("div");
 box.className="thermo-box";

 YEARS.forEach(y=>{
  const r=by[y];
  const v=r?Number(r["70% cut"]):null;

  /* 색깔 그라데이션 */
  let c="#8bf7ce";
  if(v<=2)c="#ff4b4b";
  else if(v<=3)c="#ff944d";
  else if(v<=4)c="#ffd93a";

  let h=v?((10-v)/9*100):5;

  box.innerHTML+=`
  <div class="thermo-col">
    <div>${y}학년도</div>
    <div class="thermo">
      <div class="tube">
        <div class="fill" style="background:${c};height:${h}%"></div>
      </div>
      <div class="bulb" style="background:${c}"></div>
      <div style="font-size:15px">${v?v.toFixed(2)+"등급":"-"}</div>
    </div>
  </div>
  `;
 });

 return box;
}

/* table block */
function tableBlock(by){
 let t=document.createElement("table");
 t.innerHTML=`
 <tr>
  <th>연도</th><th>50% cut</th><th>70% cut</th><th>모집인원</th><th>경쟁률</th><th>충원순위</th>
 </tr>
 `;

 YEARS.forEach((y,i)=>{
  const r=by[y];
  const prev=i===0?null:by[YEARS[i-1]];
  t.innerHTML+=`
  <tr class="${y===2025?"year2025":""}">
    <td>${y}</td>
    <td>${r?r["50% cut"]:"-"}</td>
    <td>${r?r["70% cut"]:"-"}</td>
    <td>${r?r["모집인원"]:"-"}</td>
    <td>${r?r["경쟁률"]:"-"}</td>
    <td>${r?r["충원순위"]:"-"}</td>
  </tr>
 `;
 });
 return t;
}

/* render current */
function renderCurrent(){
 const box=document.getElementById("currentBox");

 if(!detail.value){
  box.innerHTML="현재 선택된 전형이 없습니다";
  return;
 }

 const by=rows();
 box.innerHTML="";
 box.appendChild(thermoBlock(by));
 box.appendChild(tableBlock(by));
}

/* compare list */
btnAdd.onclick=()=>{
 if(!detail.value)return alert("모두 선택해주세요");
 if(compare.length>=3)return alert("최대 3개");

 compare.push({
  univ:univ.value,
  major:major.value,
  type:type.value,
  detail:detail.value
 });

 renderCompare();
}

btnReset.onclick=()=>location.reload();

function renderCompare(){
 const box=document.getElementById("compareBox");
 box.innerHTML="";
 compare.forEach(sel=>{
  const by=rows(sel);
  const d=document.createElement("div");
  d.appendChild(thermoBlock(by));
  d.appendChild(tableBlock(by));
  box.appendChild(d);
 });
}

load();
</script>

</body>
</html>
