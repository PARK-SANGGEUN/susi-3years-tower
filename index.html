<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ëª¨ë‘ì˜ ìˆ˜ì‹œ 3ê°œë…„ ì…ì‹œê²°ê³¼ ë¹„êµ ì˜¨ë„ê³„</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
body{
    font-family: Pretendard, Apple SD Gothic Neo, sans-serif;
    margin:0;
    background: linear-gradient(#ffe0cf,#f1f7ff);
    color:#333;
}

.container{
    max-width:1200px;
    margin:30px auto;
    padding:10px 20px;
}

/* ì œëª© */
.title{
    font-size:32px;
    font-weight:900;
}

/* ì €ì‘ê¶Œ / ì¶œì²˜ */
.subtitle{
    font-size:14px;
    font-weight:800;
}

/* ìƒë‹¨ ê²€ìƒ‰ ì˜ì—­ */
.search-box{
    margin-top:20px;
    background:white;
    border-radius:16px;
    box-shadow:0 5px 20px rgba(0,0,0,0.1);
    padding:20px;
}

/* ë“œë¡­ë‹¤ìš´ */
select{
    padding:10px;
    border-radius:10px;
    border:2px solid #ffa3a3;
    font-size:14px;
}

/* ë²„íŠ¼ë“¤ */
button{
    padding:10px 16px;
    border-radius:16px;
    border:none;
    font-weight:700;
    cursor:pointer;
}

.add-btn{
    background:#ff5b82;
    color:white;
}

.reset-btn{
    background:#444;
    color:white;
}

.section{
    margin-top:25px;
    background:white;
    border-radius:18px;
    padding:20px;
    box-shadow:0 5px 18px rgba(0,0,0,0.08);
}

/* ì²´ì˜¨ê³„ ì»¨í…Œì´ë„ˆ */
.thermo-wrap{
    display:flex;
    justify-content:space-around;
    gap:15px;
}

.thermo{
    width:30%;
    text-align:center;
}

/* 2025 ê°•ì¡° */
.year-badge{
    font-weight:900;
    padding:6px 12px;
    border-radius:18px;
    display:inline-block;
}

.y2025{ background:#ffe3f2; color:#ff0066; box-shadow:0 0 12px #ff0080; }
.y2024{ background:#fff2da; color:#ff8c00; }
.y2023{ background:#e5ebff; color:#274bff; }

/* ì‹¤ì œ ì²´ì˜¨ê³„ */
.bar-outer{
    margin-top:15px;
    height:210px;
    width:80px;
    border-radius:50px;
    background:linear-gradient(#ffffff,#f4f7fb);
    border:2px solid #ccc;
    position:relative;
    margin-left:auto;
    margin-right:auto;
}

/* ëˆˆê¸ˆ */
.scale-line{
    position:absolute;
    width:100%;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    height:100%;
}

.scale-line div{
    width:100%;
    border-top:1px dashed #bbb;
    font-size:10px;
    color:#666;
}

/* ê²Œì´ì§€ */
.bar-inner{
    position:absolute;
    bottom:0;
    left:0;
    width:100%;
    border-radius:50px;
    background:linear-gradient(#ff0077,#ffb36c);
}

/* ìˆ«ì ê°•ì¡° */
.score{
    margin-top:10px;
    font-size:22px;
    font-weight:900;
}

/* ë‚œì´ë„ ë¼ë²¨ */
.level-tag{
    font-weight:900;
}

/* í‘œ */
table{
    width:100%;
    text-align:center;
    border-collapse:collapse;
    margin-top:10px;
}

th{
    background:#f8fbff;
    padding:10px;
    border-bottom:2px solid #999;
}

td{
    padding:10px;
    border-bottom:1px solid #ddd;
}

/* ì„¸ë¡œì„  */
td,th{
    border-right:1px solid #ddd;
}

td:last-child, th:last-child{
    border-right:none;
}

.highlight{
    font-weight:900;
    color:#ff004c;
    background:#fff0f4;
}

.compare-box-item{
    padding:12px;
    background:#fff;
    border-radius:14px;
    margin-bottom:8px;
    border:1px solid #eee;
}
</style>
</head>
<body>

<div class="container">

<div class="title">ëª¨ë‘ì˜ ìˆ˜ì‹œ 3ê°œë…„ ì…ì‹œê²°ê³¼ ë¹„êµ ì˜¨ë„ê³„</div>

<div class="subtitle">Copyright @All Teachers</div>
<div class="subtitle">ì¶œì²˜ : ì–´ë””ê°€ 3ê°œë…„ ìˆ˜ì‹œ ì…ì‹œê²°ê³¼</div>

<div class="search-box">
<b>ê²€ìƒ‰ ê¸°ì¤€ ì„ íƒ</b><br><br>

ëŒ€í•™
<select id="univ"></select>

ëª¨ì§‘ë‹¨ìœ„
<select id="dept"></select>

ì „í˜•ìœ í˜•
<select id="type"></select>

ì„¸ë¶€ì „í˜•
<select id="detail"></select>

<button class="add-btn" onclick="addCompare()">ë¹„êµ ì¶”ê°€</button>
<button class="reset-btn" onclick="resetCompare()">ì´ˆê¸°í™”</button>

</div>

<div class="section" id="resultBox">
</div>

<div class="section" id="compareList">
<b>ì„ íƒ ë¹„êµ ëª©ë¡(ìµœëŒ€3ê°œ)</b>
</div>

</div>

<script>
let dataFile = "data/data.json";
let allData = [];
let currentItem = null;
let compareItems = [];

/* ë°ì´í„° ë¡œë“œ */
fetch(dataFile)
.then(r=>r.json())
.then(d=>{
    allData = d;
    initUniversities();
});

/* ëŒ€í•™ ë¶ˆëŸ¬ì˜¤ê¸° */
function initUniversities(){
    let unis = [...new Set(allData.map(v=>v.ëŒ€í•™))];
    let sel = document.getElementById("univ");
    sel.innerHTML = `<option value="">ì„ íƒ</option>`;
    unis.forEach(v=>{
        sel.innerHTML += `<option>${v}</option>`;
    });
    sel.onchange = onUnivChange;
}

/* ëŒ€í•™ ì„ íƒ â†’ ëª¨ì§‘ë‹¨ìœ„ */
function onUnivChange(){
    let deptSel = document.getElementById("dept");
    let filtered = allData.filter(v=>v.ëŒ€í•™==univ.value);
    let depts = [...new Set(filtered.map(v=>v.ëª¨ì§‘ë‹¨ìœ„))];
    deptSel.innerHTML = `<option value="">ì„ íƒ</option>`;
    depts.forEach(v=> deptSel.innerHTML += `<option>${v}</option>`);
    deptSel.onchange = onDeptChange;
}

/* ëª¨ì§‘ë‹¨ìœ„ ì„ íƒ â†’ ì „í˜• */
function onDeptChange(){
    let typeSel = document.getElementById("type");
    let filtered = allData.filter(v=>v.ëŒ€í•™==univ.value && v.ëª¨ì§‘ë‹¨ìœ„==dept.value);
    let types = [...new Set(filtered.map(v=>v.ì „í˜•ìœ í˜•))];
    typeSel.innerHTML = `<option value="">ì„ íƒ</option>`;
    types.forEach(v=> typeSel.innerHTML += `<option>${v}</option>`);
    typeSel.onchange = onTypeChange;
}

/* ì „í˜• ì„ íƒ â†’ ì„¸ë¶€ì „í˜• */
function onTypeChange(){
    let detSel = document.getElementById("detail");
    let filtered = allData.filter(v=>v.ëŒ€í•™==univ.value && v.ëª¨ì§‘ë‹¨ìœ„==dept.value && v.ì „í˜•ìœ í˜•==type.value);
    let dets = [...new Set(filtered.map(v=>v.ì„¸ë¶€ì „í˜•))];
    detSel.innerHTML = `<option value="">ì„ íƒ</option>`;
    dets.forEach(v=> detSel.innerHTML += `<option>${v}</option>`);
    detSel.onchange = showResult;
}

/* ê²°ê³¼ í‘œì‹œ */
function showResult(){
    let filtered = allData.filter(v=>
        v.ëŒ€í•™==univ.value &&
        v.ëª¨ì§‘ë‹¨ìœ„==dept.value &&
        v.ì „í˜•ìœ í˜•==type.value &&
        v.ì„¸ë¶€ì „í˜•==detail.value
    );

    currentItem = filtered;

    renderResult(filtered);
}

/* ì²´ì˜¨ê³„ ê²Œì´ì§€ ê³„ì‚° */
function convertGauge(score){
    let val = Math.pow((10-score),1.6);
    return Math.min(200,val*9);
}

/* ë‚œì´ë„ í…ìŠ¤íŠ¸ */
function levelText(s){
    if(s<=1.9) return "ğŸ”¥ ë§¤ìš° ì–´ë ¤ì›€";
    if(s<=2.4) return "ğŸ˜ˆ ì–´ë ¤ì›€";
    if(s<=3.0) return "ğŸ™‚ ë³´í†µ";
    return "ğŸŸ¢ ì‰¬ì›€";
}

/* ê²°ê³¼ UI */
function renderResult(list){

    if(list.length==0){
        resultBox.innerHTML = "ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.";
        return;
    }

    let yearMap = {};
    list.forEach(v=> yearMap[v.í•™ë…„ë„]=v);

    function thermo(y,colorClass){
        if(!yearMap[y]) return `<div class="thermo">ë°ì´í„°ì—†ìŒ</div>`;

        let sc = Number(yearMap[y]["70ì»·"]);
        let h = convertGauge(sc);

        return `
        <div class="thermo">
            <div class="year-badge ${colorClass}">${y}í•™ë…„ë„</div>
            <div class="bar-outer">
                <div class="scale-line">
                    <div>3.0</div><div>2.5</div><div>2.0</div><div>1.5</div><div>1.0</div>
                </div>
                <div class="bar-inner" style="height:${h}px"></div>
            </div>
            <div class="score">${sc.toFixed(2)}ë“±ê¸‰</div>
            <div class="level-tag">${levelText(sc)}</div>
        </div>
        `;
    }

    resultBox.innerHTML=`
    <h3>í˜„ì¬ ì„ íƒ ì „í˜•ì˜ 3ê°œë…„ ê²°ê³¼</h3>
    <b>${univ.value} / ${dept.value}</b><br>
    ${type.value} / ${detail.value}<br><br>

    <div class="thermo-wrap">
        ${thermo("2025","y2025")}
        ${thermo("2024","y2024")}
        ${thermo("2023","y2023")}
    </div>

    <table>
    <tr>
        <th>ì—°ë„</th>
        <th>50%ì»·</th>
        <th>70%ì»·</th>
        <th>ëª¨ì§‘ì¸ì›</th>
        <th>ê²½ìŸë¥ </th>
        <th>ì¶©ì›ìœ¨</th>
    </tr>

    ${["2025","2024","2023"].map(y=>{
        if(!yearMap[y]) return "";
        return `
        <tr>
            <td class="highlight">${y}</td>
            <td>${yearMap[y]["50ì»·"]}</td>
            <td class="highlight">${yearMap[y]["70ì»·"]}</td>
            <td>${yearMap[y]["ëª¨ì§‘ì¸ì›"]}</td>
            <td>${yearMap[y]["ê²½ìŸë¥ "]}</td>
            <td>${yearMap[y]["ì¶©ì›ìœ¨"]}</td>
        </tr>`;
    }).join("")}
    </table>
    `;
}

/* ë¹„êµ ì¶”ê°€ */
function addCompare(){
    if(!currentItem) return;
    if(compareItems.length>=3) return alert("ìµœëŒ€ 3ê°œê¹Œì§€ ë¹„êµë©ë‹ˆë‹¤.");
    compareItems.push(currentItem);
    renderCompare();
}

/* ë¹„êµ ì‚­ì œ */
function resetCompare(){
    compareItems=[];
    renderCompare();
}

/* ë¹„êµ ëª©ë¡ */
function renderCompare(){
    compareList.innerHTML = `<b>ì„ íƒ ë¹„êµ ëª©ë¡ (ìµœëŒ€3ê°œ)</b><br><br>`;
    compareItems.forEach((d,i)=>{
        compareList.innerHTML += `
        <div class="compare-box-item">
        ${d[0].ëŒ€í•™} / ${d[0].ëª¨ì§‘ë‹¨ìœ„} / ${d[0].ì„¸ë¶€ì „í˜•}
        <button onclick="compareItems.splice(${i},1);renderCompare();">ì‚­ì œ</button>
        </div>`;
    });
}
</script>

</body>
</html>
