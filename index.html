<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />

<title>ëª¨ë‘ì˜ ìˆ˜ì‹œ 3ê°œë…„ ì…ì‹œê²°ê³¼ ë¹„êµ ì˜¨ë„ê³„</title>

<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
body{
    font-family:Pretendard, sans-serif;
    margin:0;
    background:linear-gradient(#ffe2d3,#e9f2ff);
    color:#222;
}

.container{
    max-width:1200px;
    margin:20px auto;
    padding:10px 20px;
}

/* ì œëª© */
.title{
    font-size:32px;
    font-weight:900;
}

/* ì €ì‘ê¶Œ ì¶œì²˜ */
.subtitle{
    font-size:14px;
    font-weight:900;
    margin-top:2px;
}

/* ê²€ìƒ‰ë°•ìŠ¤ */
.search-box{
    margin-top:20px;
    background:white;
    border-radius:18px;
    padding:18px;
    box-shadow:0 6px 20px rgba(0,0,0,0.1);
}

/* ë“œë¡­ë‹¤ìš´ */
select{
    padding:10px;
    border-radius:10px;
    border:2px solid #ffa3a3;
    font-size:14px;
    margin-right:6px;
}

/* ë²„íŠ¼ */
button{
    padding:10px 16px;
    border-radius:16px;
    border:none;
    font-weight:900;
    cursor:pointer;
}
.add-btn{ background:#ff3f6d;color:white;}
.reset-btn{background:#222;color:white;}

.section{
    margin-top:25px;
    padding:20px;
    background:white;
    border-radius:18px;
    box-shadow:0 6px 20px rgba(0,0,0,0.07);
}

/* ========= ì²´ì˜¨ê³„ ============ */

.thermo-wrap{
    display:flex;
    justify-content:space-around;
    flex-wrap:wrap;
    gap:20px;
}

.thermo{
    width:30%;
    text-align:center;
}

/* ì—°ë„ë±ƒì§€ */
.year-badge{
    padding:6px 12px;
    border-radius:20px;
    font-weight:900;
}
.y2025{background:#ffe7f3;color:#ff0077;box-shadow:0 0 12px #ff3f7b;}
.y2024{background:#fff0da;color:#ff7a00;}
.y2023{background:#eaf0ff;color:#3a4bff;}

/* ì˜¨ë„ê³„ ëª¸í†µ */
.bar-outer{
    margin:12px auto 0;
    height:220px;
    width:90px;
    border-radius:50px;
    background:linear-gradient(#ffffff,#f3f6fa);
    border:2px solid #ccc;
    position:relative;
}

/* ëˆˆê¸ˆ */
.scale-line{
    position:absolute;
    height:100%;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    width:100%;
}

.scale-line div{
    width:100%;
    border-top:1px dashed #bbb;
    font-size:10px;
    color:#555;
}

/* ë‚´ë¶€ ê²Œì´ì§€ */
.bar-inner{
    position:absolute;
    bottom:0;
    left:0;
    width:100%;
    border-radius:50px;
    background:linear-gradient(#ff0066,#ffb36c);
}

/* ìˆ«ì */
.score{
    margin-top:12px;
    font-size:22px;
    font-weight:900;
}

/* ë‚œì´ë„ í…ìŠ¤íŠ¸ */
.level-tag{font-weight:900;}

/* í‘œ */
table{
    width:100%;
    border-collapse:collapse;
    margin-top:12px;
    text-align:center;
}

th{
    background:#f5f8ff;
    border-bottom:2px solid #777;
    padding:10px;
}
td{
    padding:9px;
    border-bottom:1px solid #ddd;
    border-right:1px solid #ddd;
}
td:last-child,th:last-child{border-right:none;}

.highlight{
    font-weight:900;
    color:#ff004c;
    background:#fff0f4;
}

/* ë¹„êµëª©ë¡ ë°•ìŠ¤ */
.compare-box-item{
    padding:10px;
    border-radius:12px;
    border:1px solid #eee;
    margin-top:6px;
}
</style>
</head>

<body>
<div class="container">

<div class="title">ëª¨ë‘ì˜ ìˆ˜ì‹œ 3ê°œë…„ ì…ì‹œê²°ê³¼ ë¹„êµ ì˜¨ë„ê³„</div>

<div class="subtitle">Copyright @All Teachers</div>
<div class="subtitle">ì¶œì²˜ : ì–´ë””ê°€ 3ê°œë…„ ìˆ˜ì‹œ ì…ì‹œê²°ê³¼</div>

<div class="search-box">
<b>ê²€ìƒ‰ ê¸°ì¤€ ì„ íƒ (í•œì¤„ ê²€ìƒ‰í˜•)</b><br><br>

ëŒ€í•™
<select id="univ"></select>

ëª¨ì§‘ë‹¨ìœ„
<select id="dept"></select>

ì „í˜•ìœ í˜•
<select id="type"></select>

ì„¸ë¶€ì „í˜•
<select id="detail"></select>

<button class="add-btn" onclick="addCompare()">ë¹„êµ ì¶”ê°€</button>
<button class="reset-btn" onclick="resetCompare()">ì´ˆê¸°í™”</button>
</div>

<div class="section" id="resultBox">
ì„ íƒëœ ì „í˜•ì˜ 3ê°œë…„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
</div>

<div class="section" id="compareList">
<b>ì„ íƒ ë¹„êµ ëª©ë¡ (ìµœëŒ€ 3ê°œ)</b>
</div>

</div>

<script>
let dataFile="data/data.json";
let allData=[];
let currentItem=null;
let compareItems=[];

/* ë°ì´í„° ë¡œë“œ */
fetch(dataFile)
.then(r=>r.json())
.then(d=>{
    allData=d;
    initUniversities();
});

/* ëŒ€í•™ ëª©ë¡ */
function initUniversities(){
    let unis=[...new Set(allData.map(v=>v.ëŒ€í•™))];
    let sel=document.getElementById("univ");
    sel.innerHTML=`<option value="">ì„ íƒ</option>`;
    unis.forEach(v=> sel.innerHTML+=`<option>${v}</option>`);
    sel.onchange=onUnivChange;
}

/* ëŒ€í•™ ì„ íƒ */
function onUnivChange(){
    let univ=document.getElementById("univ");
    let deptSel=document.getElementById("dept");

    let filtered=allData.filter(v=>v.ëŒ€í•™==univ.value);
    let depts=[...new Set(filtered.map(v=>v.ëª¨ì§‘ë‹¨ìœ„))];

    deptSel.innerHTML=`<option value="">ì„ íƒ</option>`;
    depts.forEach(v=> deptSel.innerHTML+=`<option>${v}</option>`);

    deptSel.onchange=onDeptChange;
}

/* ëª¨ì§‘ë‹¨ìœ„ ì„ íƒ */
function onDeptChange(){
    let univ=document.getElementById("univ");
    let dept=document.getElementById("dept");
    let typeSel=document.getElementById("type");

    let filtered=allData.filter(v=>v.ëŒ€í•™==univ.value && v.ëª¨ì§‘ë‹¨ìœ„==dept.value);
    let types=[...new Set(filtered.map(v=>v.ì „í˜•ìœ í˜•))];

    typeSel.innerHTML=`<option value="">ì„ íƒ</option>`;
    types.forEach(v=> typeSel.innerHTML+=`<option>${v}</option>`);

    typeSel.onchange=onTypeChange;
}

/* ì „í˜• ì„ íƒ */
function onTypeChange(){
    let univ=document.getElementById("univ");
    let dept=document.getElementById("dept");
    let type=document.getElementById("type");
    let detSel=document.getElementById("detail");

    let filtered=allData.filter(v=>v.ëŒ€í•™==univ.value && v.ëª¨ì§‘ë‹¨ìœ„==dept.value && v.ì „í˜•ìœ í˜•==type.value);
    let dets=[...new Set(filtered.map(v=>v.ì„¸ë¶€ì „í˜•))];

    detSel.innerHTML=`<option value="">ì„ íƒ</option>`;
    dets.forEach(v=> detSel.innerHTML+=`<option>${v}</option>`);

    detSel.onchange=showResult;
}

/* 1ê°œ ì„ íƒ ê²°ê³¼ í‘œì‹œ */
function showResult(){
    let univ=document.getElementById("univ");
    let dept=document.getElementById("dept");
    let type=document.getElementById("type");
    let det=document.getElementById("detail");

    let filtered=allData.filter(v=>
        v.ëŒ€í•™==univ.value &&
        v.ëª¨ì§‘ë‹¨ìœ„==dept.value &&
        v.ì „í˜•ìœ í˜•==type.value &&
        v.ì„¸ë¶€ì „í˜•==det.value
    );

    currentItem=filtered;
    renderResult(filtered);
}

/* ê²Œì´ì§€ ê¸¸ì´ ê³„ì‚° */
function convertGauge(score){
    let val=Math.pow((10-score),1.6);
    return Math.min(210,val*9);
}

/* ë‚œì´ë„ í…ìŠ¤íŠ¸ */
function levelText(s){
    if(s<=1.9) return "ğŸ”¥ ë§¤ìš° ì–´ë ¤ì›€";
    if(s<=2.4) return "ğŸ˜ˆ ì–´ë ¤ì›€";
    if(s<=3.0) return "ğŸ™‚ ë³´í†µ";
    return "ğŸŸ¢ ì‰¬ì›€";
}

/* ê²°ê³¼ í™”ë©´ ì¶œë ¥ */
function renderResult(list){

    if(list.length==0){
        resultBox.innerHTML="ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.";
        return;
    }

    let yearMap={};
    list.forEach(v=> yearMap[v.í•™ë…„ë„]=v);

    function thermo(y,cls){
        if(!yearMap[y]) return `<div class="thermo">ë°ì´í„°ì—†ìŒ</div>`;
        let sc=Number(yearMap[y]["70ì»·"]);
        let h=convertGauge(sc);

        return `
        <div class="thermo">
            <div class="year-badge ${cls}">${y}í•™ë…„ë„</div>
            <div class="bar-outer">
                <div class="scale-line">
                    <div>3.0</div><div>2.5</div><div>2.0</div><div>1.5</div><div>1.0</div>
                </div>
                <div class="bar-inner" style="height:${h}px"></div>
            </div>
            <div class="score">${sc.toFixed(2)}ë“±ê¸‰</div>
            <div class="level-tag">${levelText(sc)}</div>
        </div>`;
    }

    resultBox.innerHTML=`
    <h3>í˜„ì¬ ì„ íƒ ì „í˜•ì˜ 3ê°œë…„ ë¹„êµ ê²°ê³¼</h3>

    <b>${univ.value} / ${dept.value}</b><br>
    ${type.value} / ${detail.value}<br><br>

    <div class="thermo-wrap">
        ${thermo("2025","y2025")}
        ${thermo("2024","y2024")}
        ${thermo("2023","y2023")}
    </div>

    <table>
    <tr>
        <th>ì—°ë„</th>
        <th>50%ì»·</th>
        <th>70%ì»·</th>
        <th>ëª¨ì§‘ì¸ì›</th>
        <th>ê²½ìŸë¥ </th>
        <th>ì¶©ì›ìœ¨</th>
    </tr>
    ${["2025","2024","2023"].map(y=>{
        if(!yearMap[y]) return "";
        return `
        <tr>
            <td class="highlight">${y}</td>
            <td>${yearMap[y]["50ì»·"]}</td>
            <td class="highlight">${yearMap[y]["70ì»·"]}</td>
            <td>${yearMap[y]["ëª¨ì§‘ì¸ì›"]}</td>
            <td>${yearMap[y]["ê²½ìŸë¥ "]}</td>
            <td>${yearMap[y]["ì¶©ì›ìœ¨"]}</td>
        </tr>`;
    }).join("")}
    </table>
    `;
}

/* ë¹„êµ ì¶”ê°€ */
function addCompare(){
    if(!currentItem) return;
    if(compareItems.length>=3) return alert("ìµœëŒ€ 3ê°œê¹Œì§€ ë¹„êµ ê°€ëŠ¥");
    compareItems.push(currentItem);
    renderCompare();
}

/* ë¹„êµ ì´ˆê¸°í™” */
function resetCompare(){
    compareItems=[];
    renderCompare();
}

/* ë¹„êµ ëª©ë¡ ì¶œë ¥ */
function renderCompare(){
    compareList.innerHTML=`<b>ì„ íƒ ë¹„êµ ëª©ë¡ (ìµœëŒ€ 3ê°œ)</b><br>`;
    compareItems.forEach((d,i)=>{
        compareList.innerHTML+=`
        <div class="compare-box-item">
            ${d[0].ëŒ€í•™} / ${d[0].ëª¨ì§‘ë‹¨ìœ„} / ${d[0].ì„¸ë¶€ì „í˜•}
            <button onclick="compareItems.splice(${i},1);renderCompare();">ì‚­ì œ</button>
        </div>`;
    });
}
</script>

</body>
</html>
