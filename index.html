<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>모두의 수시 3개년 입시결과 비교 온도계</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<style>
*{box-sizing:border-box}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",sans-serif;
  background:linear-gradient(180deg,#ffe1cc,#ffeaf6 50%,#e4f3ff);
  color:#111;
}

.page{
  max-width:1180px;
  margin:0 auto;
  padding:18px 14px 70px;
}

h1{
  margin:4px 0 2px;
  font-size:30px;
  font-weight:900;
}

.sub-title{
  font-weight:700;
  font-size:15px;
  margin-bottom:4px;
}

.meta-line{
  font-size:14px;
  font-weight:900;
}

.meta-line span.value{
  color:#c00000;
}

.badge-line{
  margin-top:10px;
  display:flex;
  flex-wrap:wrap;
  gap:7px;
}

.badge{
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:900;
  color:white;
  box-shadow:0 8px 20px rgba(0,0,0,.15);
}

.badge-orange{background:linear-gradient(90deg,#ff8b5c,#ff3c73)}
.badge-blue{background:linear-gradient(90deg,#5cbcff,#8b59ff)}
.badge-gray{background:#fff;color:#555}

.card{
  background:white;
  border-radius:18px;
  padding:16px;
  box-shadow:0 10px 35px rgba(0,0,0,.1);
  margin-top:14px;
}

.card-header{
  font-weight:900;
  font-size:15px;
}

/* ---------------- Thermometer ---------------- */

.thermo-wrapper{
  display:flex;
  gap:22px;
  justify-content:space-between;
  margin-top:10px;
}

.thermo-col{
  flex:1;
  text-align:center;
  font-weight:900;
}

.thermo-col.year-2025{
  filter:drop-shadow(0 0 7px rgba(255,0,0,.3));
}

.thermo-year{margin-bottom:4px}

.thermo-body{
  position:relative;
  width:80px;
  height:210px;
  margin:0 auto 10px;
}

/* 유리관 */
.thermo-tube{
  position:absolute;
  top:0;
  left:50%;
  width:22px;
  height:160px;
  transform:translateX(-50%);
  border-radius:14px;
  background:linear-gradient(180deg,#ffffff,#eeeeee);
  border:3px solid #dddddd;
  overflow:hidden;
}

/* 눈금 */
.thermo-scale{
  position:absolute;
  top:6px;
  left:calc(50% + 22px);
  font-size:10px;
}

.thermo-scale div{
  margin:12px 0;
}

/* 수은 */
.thermo-mercury{
  position:absolute;
  bottom:0;
  width:100%;
  height:0;
  border-radius:10px;
  transition:height .7s ease;
}

.mercury-hard {background:linear-gradient(180deg,#ff0022,#ff7a00)}
.mercury-mid  {background:linear-gradient(180deg,#ffa200,#ffd56b)}
.mercury-easy {background:linear-gradient(180deg,#33dd77,#bbff88)}

/* 벌브 */
.thermo-bulb{
  position:absolute;
  bottom:-18px;
  left:50%;
  width:60px;
  height:60px;
  border-radius:50%;
  transform:translateX(-50%);
  background:radial-gradient(circle at 30% 30%,#ffabab,#ff2a4d);
  border:4px solid #dddddd;
  box-shadow:0 10px 20px rgba(0,0,0,.25);
}

.thermo-value{
  font-size:18px;
  font-weight:900;
}

/* table */
table{
  width:100%;
  border-collapse:collapse;
}

th{
  background:#fff3ed;
  font-weight:900;
  font-size:13px;
}

td{
  font-weight:900;
  font-size:14px;
}

td,th{
  padding:8px;
  border-bottom:1px solid #eee;
}

tr.highlight-2025{
  background:#fff6f0;
}
</style>

</head>
<body>

<div class="page">

<h1>모두의 수시 3개년 입시결과 비교 온도계</h1>

<div class="sub-title">대학 · 모집단위 · 전형유형 · 세부전형 선택 후 3개년 cut과 온도계 비교</div>

<div class="meta-line">Copyright <span class="value">@All Teachers</span></div>
<div class="meta-line">출처 <span class="value">3개년 어디가 수시 입시결과</span></div>

<div class="badge-line">
  <span class="badge badge-orange">실제 체온계 디자인</span>
  <span class="badge badge-blue">난이도 색상 자동 변경</span>
  <span class="badge badge-gray">2025 강조 표시</span>
</div>

<!-- 검색 카드 -->
<div class="card">
  <div class="card-header">검색 선택</div>

  <select id="univSelect"></select>
  <select id="majorSelect" disabled></select>
  <select id="typeSelect" disabled></select>
  <select id="detailSelect" disabled></select>

  <button id="addCompareBtn" disabled>비교 추가</button>
  <button id="resetBtn">초기화</button>
</div>

<!-- 현재 선택 카드 -->
<div class="card">
  <div class="card-header">현재 선택 결과</div>
  <div id="currentResult"></div>
</div>

<!-- 비교 카드 -->
<div class="card">
  <div class="card-header">비교 목록</div>
  <div id="compareList"></div>
</div>

</div>

<script>
const YEARS=[2025,2024,2023];
let DATA=[];
let compareSelections=[];

function extractYear(v){
  let m=String(v).match(/(20\d{2})/);
  return m?Number(m[1]):null;
}

function normalizeRow(r){
  r._year=extractYear(r["연도"]);
}

async function loadData(){
  const res=await fetch("data/data.json");
  DATA=await res.json();
  DATA.forEach(normalizeRow);
  initUniv();
}

/* ================= 드롭다운 =================== */

const univSelect=document.getElementById("univSelect");
const majorSelect=document.getElementById("majorSelect");
const typeSelect=document.getElementById("typeSelect");
const detailSelect=document.getElementById("detailSelect");

function fill(sel,list,txt){
  sel.innerHTML="";
  sel.disabled=false;
  sel.append(new Option(txt,""));
  list.forEach(v=>sel.append(new Option(v,v)));
}

function initUniv(){
  const list=[...new Set(DATA.map(r=>r["대학명"]))].sort();
  fill(univSelect,list,"대학 선택");
}

univSelect.onchange=()=>{
  let f=DATA.filter(r=>r["대학명"]===univSelect.value);
  fill(majorSelect,[...new Set(f.map(r=>r["모집단위"]))],"모집단위 선택");
  majorSelect.onchange=()=>{
    let f2=f.filter(r=>r["모집단위"]===majorSelect.value);
    fill(typeSelect,[...new Set(f2.map(r=>r["중심전형"]))],"전형 선택");
    typeSelect.onchange=()=>{
      let f3=f2.filter(r=>r["중심전형"]===typeSelect.value);
      fill(detailSelect,[...new Set(f3.map(r=>r["전형명"]))],"세부전형 선택");
      detailSelect.onchange=()=>{
        renderCurrent({
          univ:univSelect.value,
          major:majorSelect.value,
          type:typeSelect.value,
          detail:detailSelect.value
        });
        document.getElementById("addCompareBtn").disabled=false;
      }
    }
  }
}

/* ================= Thermometer =================== */

function createThermoBlock(rowsByYear){

  const wrapper=document.createElement("div");
  wrapper.className="thermo-wrapper";

  YEARS.forEach(year=>{

    const col=document.createElement("div");
    col.className="thermo-col";
    if(year===2025)col.classList.add("year-2025");

    const yearLabel=document.createElement("div");
    yearLabel.className="thermo-year";
    yearLabel.textContent=year+"학년도";
    col.appendChild(yearLabel);

    const body=document.createElement("div");
    body.className="thermo-body";

    const tube=document.createElement("div");
    tube.className="thermo-tube";

    const merc=document.createElement("div");
    merc.className="thermo-mercury";

    const bulb=document.createElement("div");
    bulb.className="thermo-bulb";

    const scale=document.createElement("div");
    scale.className="thermo-scale";

    for(let g=1;g<=6;g++){
      const m=document.createElement("div");
      m.textContent=g+".0";
      scale.appendChild(m);
    }

    const row=rowsByYear[year];
    const v=row && Number(row["70% cut"])||null;

    let h=0;
    let t="데이터 없음";

    if(v){
      t=v.toFixed(2)+"등급";
      h=(10-v)/9*100;
      if(h<10)h=10;
      if(v<=2.5)merc.classList.add("mercury-hard");
      else if(v<=3.5)merc.classList.add("mercury-mid");
      else merc.classList.add("mercury-easy");
    }

    tube.appendChild(merc);
    body.appendChild(tube);
    body.appendChild(scale);
    body.appendChild(bulb);
    col.appendChild(body);

    const value=document.createElement("div");
    value.className="thermo-value";
    value.textContent=t;
    col.appendChild(value);

    setTimeout(()=>merc.style.height=h+"%",50);

    wrapper.appendChild(col);
  });

  return wrapper;
}

/* ================= TABLE =================== */

function createTable(rows){
  const tbl=document.createElement("table");
  tbl.innerHTML=`<tr>
    <th>연도</th><th>50% cut</th><th>70% cut</th>
    <th>모집인원</th><th>경쟁률</th><th>충원율</th>
  </tr>`;

  YEARS.forEach(y=>{
    const r=rows[y]||{};
    const tr=document.createElement("tr");
    if(y===2025)tr.classList.add("highlight-2025");
    tr.innerHTML=`<td>${y}</td>
    <td>${r["50% cut"]||"-"}</td>
    <td>${r["70% cut"]||"-"}</td>
    <td>${r["모집인원"]||"-"}</td>
    <td>${r["경쟁률"]||"-"}</td>
    <td>${r["충원율"]||"-"}</td>`;
    tbl.appendChild(tr);
  });

  return tbl;
}

/* ================= CURRENT RESULT =================== */

function getRows(sel){
  let o={};
  YEARS.forEach(y=>{
    o[y]=DATA.find(r=>
      r._year===y &&
      r["대학명"]===sel.univ &&
      r["모집단위"]===sel.major &&
      r["중심전형"]===sel.type &&
      r["전형명"]===sel.detail
    )||null;
  });
  return o;
}

const currentResult=document.getElementById("currentResult");

function renderCurrent(sel){
  currentResult.innerHTML="";
  if(!sel)return;
  const rows=getRows(sel);
  currentResult.appendChild(createThermoBlock(rows));
  currentResult.appendChild(createTable(rows));
}

/* ================= COMPARE =================== */

const compareList=document.getElementById("compareList");

document.getElementById("addCompareBtn").onclick=()=>{
  compareSelections.push({
    univ:univSelect.value,
    major:majorSelect.value,
    type:typeSelect.value,
    detail:detailSelect.value
  });
  renderCompare();
};

function renderCompare(){
  compareList.innerHTML="";
  compareSelections.forEach(sel=>{
    const box=document.createElement("div");
    box.className="card";
    box.innerHTML=`<b>${sel.univ} / ${sel.major}</b> [${sel.type}] ${sel.detail}`;
    const rows=getRows(sel);
    box.appendChild(createThermoBlock(rows));
    box.appendChild(createTable(rows));
    compareList.appendChild(box);
  });
}

document.getElementById("resetBtn").onclick=()=>location.reload();

loadData();
</script>

</body>
</html>
